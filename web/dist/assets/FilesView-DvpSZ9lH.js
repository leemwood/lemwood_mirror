import{c as z,a as u,o as r,b as a,r as v,n as y,u as s,d as b,_ as A,e as w,f as R,g as G,h as O,i as g,j as l,F as k,k as $,l as P,w as n,m as F,C as Q,p as W,q as Z,s as H,t as f,v as J,x as K,y as x,z as X,A as Y,B as ee,D as te,E as se,G as ae}from"./index-uoWG8RoL.js";import{S as le,_ as oe}from"./Input-Cny23hbi.js";/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=z("FileArchiveIcon",[["path",{d:"M16 22h2a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v18",key:"1oywqq"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=z("FileIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=z("HardDriveIcon",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),ie={class:"relative w-full overflow-auto"},ue={__name:"Table",props:{class:{type:String,default:""}},setup(h){return(o,p)=>(r(),u("div",ie,[a("table",{class:y(s(b)("w-full caption-bottom text-sm",o.$props.class))},[v(o.$slots,"default")],2)]))}},ce={__name:"TableHeader",props:{class:{type:String,default:""}},setup(h){return(o,p)=>(r(),u("thead",{class:y(s(b)("[&_tr]:border-b",o.$props.class))},[v(o.$slots,"default")],2))}},me={__name:"TableBody",props:{class:{type:String,default:""}},setup(h){return(o,p)=>(r(),u("tbody",{class:y(s(b)("[&_tr:last-child]:border-0",o.$props.class))},[v(o.$slots,"default")],2))}},B={__name:"TableRow",props:{class:{type:String,default:""}},setup(h){return(o,p)=>(r(),u("tr",{class:y(s(b)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",o.$props.class))},[v(o.$slots,"default")],2))}},S={__name:"TableHead",props:{class:{type:String,default:""}},setup(h){return(o,p)=>(r(),u("th",{class:y(s(b)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",o.$props.class))},[v(o.$slots,"default")],2))}},V={__name:"TableCell",props:{class:{type:String,default:""}},setup(h){return(o,p)=>(r(),u("td",{class:y(s(b)("p-4 align-middle [&:has([role=checkbox])]:pr-0",o.$props.class))},[v(o.$slots,"default")],2))}},pe={class:"flex flex-col h-full space-y-6 max-w-full overflow-hidden"},fe={class:"flex flex-col md:flex-row md:items-center justify-between gap-4 shrink-0"},_e={class:"relative w-full md:w-96"},he={key:0,class:"space-y-4"},ge={class:"flex gap-2 overflow-x-auto pb-2"},xe={class:"rounded-md border"},ve={class:"p-4 space-y-4"},ye={key:1,class:"flex flex-col items-center justify-center p-12 border rounded-lg border-dashed bg-muted/10"},be={class:"flex h-20 w-20 items-center justify-center rounded-full bg-muted"},we={class:"overflow-x-auto pb-2 -mx-1 px-1 shrink-0"},ke={class:"ml-2 rounded-full bg-primary/10 px-2 py-0.5 text-xs text-primary"},$e={class:"rounded-md border bg-card overflow-hidden"},Ce={class:"overflow-x-auto w-full"},Le={class:"flex items-center gap-3 min-w-0"},Se={class:"flex h-9 w-9 shrink-0 items-center justify-center rounded bg-muted/50"},Ve={class:"flex flex-col min-w-0 flex-1"},je={class:"overflow-x-auto whitespace-nowrap scrollbar-hide"},Fe=["title"],ze={class:"md:hidden text-xs text-muted-foreground"},De={class:"inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 text-foreground"},Te={class:"flex justify-end gap-2"},Me={__name:"FilesView",setup(h){const o=w(!0),p=w(""),C=w([]),D=w({}),L=w(""),{copy:E}=R(),T=async()=>{o.value=!0;try{const[i,e]=await Promise.all([W(),Z()]);C.value=Object.entries(i.data).map(([t,d])=>({name:t,versions:d.sort((c,m)=>String(m.tag_name||m.name).localeCompare(String(c.tag_name||c.name)))})),D.value=e.data,C.value.length&&!L.value&&(L.value=C.value[0].name)}catch(i){console.error(i)}finally{o.value=!1}},I=i=>{var t;const e=(t=i.split(".").pop())==null?void 0:t.toLowerCase();return["zip","tar","gz","7z","rar"].includes(e)?ne:["exe","msi","apk","dmg"].includes(e)?de:re},M=i=>{if(!i)return"未知";try{return new Date(i).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return i}},N=i=>{E(i)},j=G(()=>{const i=p.value.toLowerCase().trim(),e=[];return C.value.forEach(t=>{const d=[];t.versions.forEach(c=>{var q;const m=c.tag_name||c.name,U=D.value[t.name]===m;(q=c.assets)==null||q.forEach(_=>{(!i||t.name.toLowerCase().includes(i)||m.toLowerCase().includes(i)||_.name.toLowerCase().includes(i))&&d.push({id:`${t.name}-${m}-${_.name}`,name:_.name,version:m,published_at:c.published_at,isLatest:U,launcher:t.name,downloadUrl:_.url&&_.url.startsWith("http")?_.url:`${window.location.origin}/download/${t.name}/${m}/${_.name}`})})}),d.length&&e.push({name:t.name,files:d.sort((c,m)=>m.isLatest-c.isLatest||m.published_at.localeCompare(c.published_at)),totalFiles:d.length})}),e.sort((t,d)=>t.name.localeCompare(d.name))});return O(()=>{T()}),(i,e)=>(r(),u("div",pe,[a("div",fe,[e[2]||(e[2]=a("div",{class:"min-w-0"},[a("h2",{class:"text-3xl font-bold tracking-tight truncate"},"文件浏览"),a("p",{class:"text-muted-foreground truncate"},"浏览所有已收录的镜像文件")],-1)),a("div",_e,[l(s(le),{class:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),l(oe,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),type:"search",placeholder:"搜索文件名、版本或启动器...",class:"pl-8 bg-background"},null,8,["modelValue"])])]),o.value?(r(),u("div",he,[a("div",ge,[(r(),u(k,null,$(4,t=>l(H,{class:"h-10 w-24 rounded-md shrink-0",key:t})),64))]),a("div",xe,[a("div",ve,[(r(),u(k,null,$(5,t=>l(H,{class:"h-10 w-full",key:t})),64))])])])):j.value.length?(r(),g(s(Q),{key:2,modelValue:L.value,"onUpdate:modelValue":e[1]||(e[1]=t=>L.value=t),class:"flex flex-col space-y-4 min-h-0"},{default:n(()=>[a("div",we,[l(s(J),{class:"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground"},{default:n(()=>[(r(!0),u(k,null,$(j.value,t=>(r(),g(s(K),{key:t.name,value:t.name,class:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm"},{default:n(()=>[f(x(t.name)+" ",1),a("span",ke,x(t.totalFiles),1)]),_:2},1032,["value"]))),128))]),_:1})]),(r(!0),u(k,null,$(j.value,t=>(r(),g(s(X),{key:t.name,value:t.name,class:"outline-none min-h-0"},{default:n(()=>[a("div",$e,[a("div",Ce,[l(s(ue),{class:"min-w-full"},{default:n(()=>[l(s(ce),null,{default:n(()=>[l(s(B),null,{default:n(()=>[l(s(S),{class:"min-w-[150px] sm:min-w-[200px] max-w-[300px]"},{default:n(()=>[...e[6]||(e[6]=[f("文件名",-1)])]),_:1}),l(s(S),{class:"min-w-[80px]"},{default:n(()=>[...e[7]||(e[7]=[f("版本",-1)])]),_:1}),l(s(S),{class:"hidden md:table-cell min-w-[150px]"},{default:n(()=>[...e[8]||(e[8]=[f("发布时间",-1)])]),_:1}),l(s(S),{class:"text-right min-w-[100px]"},{default:n(()=>[...e[9]||(e[9]=[f("操作",-1)])]),_:1})]),_:1})]),_:1}),l(s(me),null,{default:n(()=>[(r(!0),u(k,null,$(t.files,d=>(r(),g(s(B),{key:d.id},{default:n(()=>[l(s(V),{class:"font-medium"},{default:n(()=>[a("div",Le,[a("div",Se,[(r(),g(ee(I(d.name)),{class:"h-5 w-5 text-muted-foreground"}))]),a("div",Ve,[a("div",je,[a("span",{class:"font-medium",title:d.name},x(d.name),9,Fe)]),a("span",ze,x(M(d.published_at)),1)]),d.isLatest?(r(),g(te,{key:0,variant:"secondary",class:"bg-green-100 text-green-800 hover:bg-green-100 dark:bg-green-900 dark:text-green-100 border-transparent h-5 text-[10px] px-1.5 shrink-0"},{default:n(()=>[...e[10]||(e[10]=[f("LATEST",-1)])]),_:1})):Y("",!0)])]),_:2},1024),l(s(V),null,{default:n(()=>[a("div",De,x(d.version),1)]),_:2},1024),l(s(V),{class:"hidden md:table-cell text-muted-foreground text-sm"},{default:n(()=>[f(x(M(d.published_at)),1)]),_:2},1024),l(s(V),{class:"text-right"},{default:n(()=>[a("div",Te,[l(F,{size:"sm",variant:"outline",class:"h-8 px-2 lg:px-3",as:"a",href:d.downloadUrl},{default:n(()=>[l(s(se),{class:"mr-2 h-3.5 w-3.5"}),e[11]||(e[11]=a("span",{class:"hidden lg:inline"},"下载",-1))]),_:1},8,["href"]),l(F,{size:"sm",variant:"ghost",class:"h-8 w-8 px-0",onClick:c=>N(d.downloadUrl)},{default:n(()=>[l(s(ae),{class:"h-3.5 w-3.5"}),e[12]||(e[12]=a("span",{class:"sr-only"},"复制链接",-1))]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)])])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])):(r(),u("div",ye,[a("div",be,[l(s(P),{class:"h-10 w-10 text-muted-foreground opacity-50"})]),e[4]||(e[4]=a("h3",{class:"mt-4 text-lg font-semibold"},"无匹配结果",-1)),e[5]||(e[5]=a("p",{class:"mb-4 mt-2 text-center text-sm text-muted-foreground max-w-sm"}," 我们找不到与您的搜索相关的任何文件。请尝试使用不同的关键词。 ",-1)),l(F,{variant:"outline",onClick:T},{default:n(()=>[...e[3]||(e[3]=[f("刷新列表",-1)])]),_:1})]))]))}},Ee=A(Me,[["__scopeId","data-v-c32a9fcd"]]);export{Ee as default};
